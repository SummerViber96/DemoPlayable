window.__require=function t(e,n,i){function o(r,s){if(!n[r]){if(!e[r]){var c=r.split("/");if(c=c[c.length-1],!e[c]){var h="function"==typeof __require&&__require;if(!s&&h)return h(c,!0);if(a)return a(c,!0);throw new Error("Cannot find module '"+r+"'")}r=c}var l=n[r]={exports:{}};e[r][0].call(l.exports,function(t){return o(e[r][1][t]||t)},l,l.exports,t,e,n,i)}return n[r].exports}for(var a="function"==typeof __require&&__require,r=0;r<i.length;r++)o(i[r]);return o}({GameManager:[function(t,e){"use strict";cc._RF.push(e,"3fc11YGSKRP7LSbbzZFq4U2","GameManager"),window.GameManager=cc.Class({extends:cc.Component,properties:{VictoryUI:cc.Node,nodeSKill:cc.Node},start:function(){this.initGame()},initGame:function(){this.addWay(),this.addHero()},addWay:function(){var t=this,e=this.node.getComponent("enemyManager").init("goblin",1.5,5);this.enemies=e,this.scheduleOnce(function(){var e,n=t.node.getComponent("enemyManager").init("barduk",1.5,1);(e=t.enemies).push.apply(e,n)},6),cc.log(this.enemies);for(var n=0;n<this.enemies.length;n++)this.enemies[n].enemyID=n},addHero:function(){var t=cc.find("hero",this.node);this.heros=[t]},clearEnemies:function(t){var e=this;this.enemies.splice(t.enemyID,1);for(var n=0;n<this.enemies.length;n++)this.enemies[n].enemyID=n;this.scheduleOnce(function(){e.checkComplete()},4)},checkComplete:function(){this.enemies.length<=0&&(cc.log("victory"),this.VictoryUI.getComponent("victoryUI").getStart())},focusHero:function(t,e){this.nodeSKill.active=!0;var n=t.position;e.parent=this.nodeSKill,t.parent=this.nodeSKill,cc.tween(this.nodeSKill).to(.5,{scale:2,position:cc.v2(-n.x-250,-n.y)}).start()}}),cc._RF.pop()},{}],WayPoint:[function(t,e){"use strict";cc._RF.push(e,"75633JMAY5I5bjRE5E/VPKS","WayPoint");var n=[cc.v2(700,-11),cc.v2(519,-41),cc.v2(412,-89),cc.v2(237,-111),cc.v2(106,-158),cc.v2(-120,-182),cc.v2(-400,-190),cc.v2(-768,-190)];e.exports=n,cc._RF.pop()},{}],barduk:[function(t,e){"use strict";cc._RF.push(e,"83ce2g/TiZMa6MS2g7ySFp6","barduk");var n,i=(n=t("../WayPoint"))&&n.__esModule?n:{default:n};function o(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=a(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0;return function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function a(t,e){if(t){if("string"==typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}}function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}cc.Class({extends:cc.Component,properties:{nodeHp:cc.Node},start:function(){this.mainGame=this.node.parent.parent.getComponent("GameManager")},getCreate:function(t){var e=this;this.hp=40,this.localHp=40,this.moveDuration=6,this.currentWayPoint=0,this.atackRange=300,this.arrAttack=[],this.targetHero=null,this.fireRate=1.5,this.damage=5;var n=this.getCurrentWayPoint();this.node.position=n,this.scheduleOnce(function(){e.move()},t)},move:function(){var t=this,e=this.getNextWayPoint();null!=e?cc.tween(this.node).to(this.moveDuration,{position:e}).call(function(){t.move()}).start():cc.log("quai da ra khoi vong")},getCurrentWayPoint:function(){return i.default[this.currentWayPoint]},getNextWayPoint:function(){return 8==this.currentWayPoint?(this.currentWayPoint=0,null):(this.currentWayPoint+=1,i.default[this.currentWayPoint])},hitDamage:function(t){this.hp-=t,this.nodeHp.active=!0,this.nodeHp.getComponent(cc.ProgressBar).progress=this.hp/this.localHp,cc.tween(this.node).to(.3,{color:(new cc.Color).fromHEX("#C25858")}).to(.2,{color:(new cc.Color).fromHEX("#ffffff")}).start(),this.hp<=0&&(cc.log("die"),this.getDie())},getDie:function(){for(var t,e=this,n=o(this.arrAttack);!(t=n()).done;){var i=t.value;i.getComponent(i.name).targetKilled()}this.unschedule(this.shot),this.nodeHp.active=!1,this.node.stopAllActions(),this.scheduleOnce(function(){e.node.getComponent(sp.Skeleton).setAnimation(0,"die",!1)},2),this.mainGame.clearEnemies(this.node),this.scheduleOnce(function(){e.node.destroy()},4)},getAttack:function(t){this.arrAttack.push(t)},update:function(){if(this.targetHero)this.node.position.sub(this.targetHero.position).mag(),this.atackRange;else for(var t,e=o(this.mainGame.heros);!(t=e()).done;){var n=t.value;this.node.position.sub(n.position).mag()<this.atackRange&&this.choseEnemy(n)}},choseEnemy:function(t){this.targetHero=t,this.node.stopAllActions(),this.shot(),this.schedule(this.shot,this.fireRate)},shot:function(){var t=this;this.node.getComponent(sp.Skeleton).setAnimation(0,"attack_melee_1",!1),this.scheduleOnce(function(){t.dameEnemy()},.15)},dameEnemy:function(){cc.log("dame"),this.targetHero&&this.targetHero.getComponent("hero").hitDamage(this.damage)}}),cc._RF.pop()},{"../WayPoint":"WayPoint"}],enemyManager:[function(t,e){"use strict";cc._RF.push(e,"35656etA+5NPIjh3dZIUV4t","enemyManager"),cc.Class({extends:cc.Component,properties:{preGoblin:cc.Prefab,preBarduk:cc.Prefab,mainEnemies:cc.Node},start:function(){},init:function(t,e,n){cc.log("start"),this.creep=t,this.spawRate=e,this.totalCreeps=n;for(var i=[],o=0;o<n;o++)if("goblin"==t){var a=this.createGoblin(e*o);a.name=t,a.parent=this.mainEnemies,i.push(a)}else if("barduk"==t){var r=this.createBarduk(e*o);r.parent=this.mainEnemies,r.name=t,i.push(r)}return i},createGoblin:function(t){cc.log("create");var e=cc.instantiate(this.preGoblin);return e.getComponent("goblin").getCreate(t),e},createBarduk:function(t){var e=cc.instantiate(this.preBarduk);return e.getComponent("barduk").getCreate(t),e}}),cc._RF.pop()},{}],goblin:[function(t,e){"use strict";cc._RF.push(e,"32f59HuXeVH9oH/iTfBE6Dd","goblin");var n,i=(n=t("../WayPoint"))&&n.__esModule?n:{default:n};function o(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=a(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0;return function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function a(t,e){if(t){if("string"==typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}}function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}cc.Class({extends:cc.Component,properties:{nodeHp:cc.Node},start:function(){this.mainGame=this.node.parent.parent.getComponent("GameManager")},getCreate:function(t){var e=this;this.hp=10,this.localHp=10,this.moveDuration=3,this.currentWayPoint=0,this.atackRange=150,this.arrAttack=[],this.targetHero=null;var n=this.getCurrentWayPoint();this.node.position=n,this.scheduleOnce(function(){e.move()},t)},move:function(){var t=this,e=this.getNextWayPoint();null!=e?cc.tween(this.node).to(this.moveDuration,{position:e}).call(function(){t.move()}).start():cc.log("quai da ra khoi vong")},getCurrentWayPoint:function(){return i.default[this.currentWayPoint]},getNextWayPoint:function(){return 8==this.currentWayPoint?(this.currentWayPoint=0,null):(this.currentWayPoint+=1,i.default[this.currentWayPoint])},hitDamage:function(t){this.hp-=t,this.nodeHp.active=!0,this.nodeHp.getComponent(cc.ProgressBar).progress=this.hp/this.localHp,cc.tween(this.node).to(.3,{color:(new cc.Color).fromHEX("#C25858")}).to(.2,{color:(new cc.Color).fromHEX("#ffffff")}).start(),this.hp<=0&&(cc.log("die"),this.getDie())},getDie:function(){for(var t,e=this,n=o(this.arrAttack);!(t=n()).done;){var i=t.value;i.getComponent(i.name).targetKilled()}this.nodeHp.active=!1,this.node.stopAllActions(),this.node.getComponent(sp.Skeleton).setAnimation(0,"die",1),this.node.parent.parent.getComponent("GameManager").clearEnemies(this.node),this.scheduleOnce(function(){e.node.destroy()},1)},getAttack:function(t){this.arrAttack.push(t)},update:function(){if(this.targetHero)this.node.position.sub(this.targetHero.position).mag(),this.atackRange;else for(var t,e=o(this.mainGame.heros);!(t=e()).done;){var n=t.value;this.node.position.sub(n.position).mag()<this.atackRange&&this.choseEnemy(n)}},choseEnemy:function(t){this.targetHero=t,this.node.stopAllActions(),this.node.getComponent(sp.Skeleton).setAnimation(0,"attack_melee_1",!0)}}),cc._RF.pop()},{"../WayPoint":"WayPoint"}],hero:[function(t,e){"use strict";function n(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=i(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var o=0;return function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function i(t,e){if(t){if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(t,e):void 0}}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}cc._RF.push(e,"35275YCHCBGlYZJsjD1RzKK","hero"),cc.Class({extends:cc.Component,properties:{animHero:sp.Skeleton,hpBar:cc.Node,animSkill:cc.Node},start:function(){this.mainGame=this.node.parent.getComponent("GameManager"),this.init()},init:function(){this.hp=100,this.localHp=100,this.moveDuration=3,this.speed=150,this.damage=3,this.atackRange=150,this.lookRange=300,this.targetEnemy=null,this.fireRate=1,this.skill=0},update:function(){if(this.targetEnemy)this.node.position.sub(this.targetEnemy.position).mag(),this.atackRange;else for(var t,e=n(this.mainGame.enemies);!(t=e()).done;){var i=t.value;if(this.node.position.sub(i.position).mag()<this.lookRange)return void this.choseEnemy(i)}},lostSight:function(){this.targetEnemy&&(cc.log("lostSize"),this.targetEnemy=null),this.unschedule(this.shot)},getSkillLucius:function(){var t=this;this.hpBar.active=!1,this.scheduleOnce(function(){t.animSkill.active=!0,t.animHero.setAnimation(0,"skill_active",!1),t.animHero.timeScale=.5,t.animSkill.getComponent(sp.Skeleton).setAnimation(0,"skill_active",!1),t.animSkill.getComponent(sp.Skeleton).timeScale=.5},.5)},choseEnemy:function(t){var e=this;this.targetEnemy=t,this.targetEnemy.getComponent(t.name).getAttack(this.node);var n=this.node.position.sub(t.position).mag();if(cc.log(n,"attack"),n>this.atackRange){this.animHero.setAnimation(0,"run",1,!0);var i=this.targetEnemy.position.add(cc.v2(-this.atackRange,0)),o=this.getVector(n);cc.log(o),cc.tween(this.node).to(o,{position:i}).call(function(){cc.log("shot enemy"),e.shot(),e.schedule(e.shot,e.fireRate)}).start()}else this.schedule(this.shot,this.fireRate)},getVector:function(t){return t/this.speed},shot:function(){var t=this;if("barduk"==this.targetEnemy.name&&this.targetEnemy.getComponent("barduk").hp<=15)return this.mainGame.focusHero(this.node,this.targetEnemy),this.targetEnemy.getComponent("barduk").hitDamage(15),void this.getSkillLucius();this.hpBar.active=!0,this.skill+=1,cc.log("shott",this.skill),1==this.skill?this.animHero.setAnimation(0,"attack_melee_1",!1):2==this.skill&&(this.animHero.setAnimation(0,"attack_melee_2",!1),this.skill=0),this.scheduleOnce(function(){t.dameEnemy()},.15)},dameEnemy:function(){cc.log("dame"),this.targetEnemy&&("goblin"==this.targetEnemy.name?this.targetEnemy.getComponent("goblin").hitDamage(this.damage):"barduk"==this.targetEnemy.name&&this.targetEnemy.getComponent("barduk").hitDamage(this.damage))},targetKilled:function(){this.targetEnemy&&(this.targetEnemy=null,this.unschedule(this.shot),this.animHero.addAnimation(0,"idle",!0),this.node.stopAllActions())},hitDamage:function(t){this.hp-=t,this.hpBar.active=!0,this.hpBar.getComponent(cc.ProgressBar).progress=this.hp/this.localHp}}),cc._RF.pop()},{}],towerMagic:[function(t,e){"use strict";function n(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=i(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var o=0;return function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function i(t,e){if(t){if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(t,e):void 0}}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}cc._RF.push(e,"91d66kell9FObyJ+OR1bVF8","towerMagic"),cc.Class({extends:cc.Component,properties:{preBullet:cc.Prefab,GameMain:cc.Node,animTower:sp.Skeleton},start:function(){this.mainGame=this.node.parent.getComponent("GameManager"),this.init()},init:function(){this.atackRange=450,this.damage=1,this.fireRate=1.5},update:function(){if(this.targetEnemy)this.node.position.sub(this.targetEnemy.position).mag()<450||this.lostSight();else for(var t,e=n(this.mainGame.enemies);!(t=e()).done;){var i=t.value;if(this.node.position.sub(i.position).mag()<this.atackRange)return void this.choseEnemy(i)}},choseEnemy:function(t){this.targetEnemy=t,"goblin"==this.targetEnemy.name?this.targetEnemy.getComponent("goblin").getAttack(this.node):"barduk"==this.targetEnemy.name&&this.targetEnemy.getComponent("barduk").getAttack(this.node),this.schedule(this.shot,this.fireRate)},lostSight:function(){this.targetEnemy&&(this.targetEnemy=null),this.animTower.addAnimation(0,"idle_1",1,!0),this.unschedule(this.shot)},shot:function(){var t=this;this.animTower.setAnimation(0,"attack_range_1",!1);var e=cc.instantiate(this.preBullet);e.parent=this.GameMain,e.position=this.node.position.add(cc.v2(40,180)),e.scale=.1,cc.tween(e).delay(.3).to(.2,{position:this.targetEnemy.position,scale:.3}).call(function(){t.dameEnemy(),e.getComponent(sp.Skeleton).setAnimation(0,"attack_impact",1),t.removeBullet(e)}).start()},dameEnemy:function(){this.targetEnemy&&("goblin"==this.targetEnemy.name?this.targetEnemy.getComponent("goblin").hitDamage(this.damage):"barduk"==this.targetEnemy.name&&this.targetEnemy.getComponent("barduk").hitDamage(this.damage))},removeBullet:function(t){this.scheduleOnce(function(){t.destroy()},.3)},targetKilled:function(){this.targetEnemy&&(this.targetEnemy=null,this.unschedule(this.shot),this.animTower.addAnimation(0,"idle_1",1,!0))}}),cc._RF.pop()},{}],tower:[function(t,e){"use strict";function n(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=i(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var o=0;return function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function i(t,e){if(t){if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(t,e):void 0}}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}cc._RF.push(e,"032e4E+lTdEbo6csxfPbmrV","tower"),cc.Class({extends:cc.Component,properties:{fx:sp.Skeleton,fxNode:cc.Node,animTower:sp.Skeleton},start:function(){this.mainGame=this.node.parent.getComponent("GameManager"),this.init()},init:function(){this.atackRange=200,this.damage=2,this.fireRate=1.8},update:function(){if(this.targetEnemy)this.node.position.sub(this.targetEnemy.position).mag()<450||this.lostSight();else for(var t,e=n(this.mainGame.enemies);!(t=e()).done;){var i=t.value;if(this.node.position.sub(i.position).mag()<this.atackRange)return void this.choseEnemy(i)}},choseEnemy:function(t){cc.log("chose Enemy"),this.targetEnemy=t,this.targetEnemy.getComponent(this.targetEnemy.name).getAttack(this.node),this.schedule(this.shot,this.fireRate)},lostSight:function(){this.targetEnemy&&(this.targetEnemy=null),this.animTower.addAnimation(0,"idle",1,0),this.unschedule(this.shot)},shot:function(){var t=this;if(this.targetEnemy){this.animTower.setAnimation(0,"attack_range",!1),this.fxNode.active=!0;var e=this.targetEnemy.position;e=this.targetEnemy.parent.convertToWorldSpaceAR(e),e=this.node.convertToNodeSpaceAR(e),this.fxNode.position=e,this.fxNode.getComponent(sp.Skeleton).setAnimation(0,"attack_range",!1),this.scheduleOnce(function(){t.fxNode.active=!1},1),this.scheduleOnce(function(){t.dameEnemy()},.6)}},dameEnemy:function(){this.targetEnemy&&("goblin"==this.targetEnemy.name?this.targetEnemy.getComponent("goblin").hitDamage(this.damage):"barduk"==this.targetEnemy.name&&this.targetEnemy.getComponent("barduk").hitDamage(this.damage))},getIdle:function(){this.node.getComponent(sp.Skeleton).addAnimation(0,"idle",1,0),this.node.targetEnemy=null},_completeAnim:function(){this.targetEnemy&&(this.fxNode.active=!0,this.fx.addAnimation(0,"attack_range",1))},targetKilled:function(){this.targetEnemy&&(this.targetEnemy=null,this.unschedule(this.shot),this.animTower.addAnimation(0,"idle",1,0))}}),cc._RF.pop()},{}],victoryUI:[function(t,e){"use strict";cc._RF.push(e,"89294asKMtOEYDZ9KVlenp2","victoryUI"),cc.Class({extends:cc.Component,properties:{board:cc.Node,btnInstall:cc.Node},start:function(){},getStart:function(){this.node.active=!0,this.board.scale=0,cc.tween(this.board).to(.4,{scale:1,easing:"backOut"}).start(),cc.tween(this.btnInstall).repeatForever(cc.tween().to(.6,{scale:1.2,easing:"sineOut"}).to(.6,{scale:1,easing:"sineIn"})).start()},btn_install:function(){cc.sys.openURL("https://play.google.com/store/apps/details?id=com.zitga.empire.warriors.td")}}),cc._RF.pop()},{}]},{},["GameManager","WayPoint","barduk","enemyManager","goblin","hero","tower","towerMagic","victoryUI"]);